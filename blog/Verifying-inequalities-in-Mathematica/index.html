<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
     <link rel="stylesheet" href="/libs/highlight/github.min.css">
   
    <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/tufte.css">
<link rel="stylesheet" href="/css/latex.css">
<link rel="stylesheet" href="/css/adjust.css"> <!-- sheet to overwrite some clashing styles -->
<link rel="icon" href="/assets/favicon.png">

     <title>Verifying inequalities in Mathematica</title>  
</head>

<body>
<div id="layout">
  <div id="menu">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/tags/">Tags</a></li>
    </ul>
  </div>
  <div id="main">



<!-- Content appended here -->
<div class="franklin-content"><h1 id="verifying_inequalities_in_mathematica"><a href="#verifying_inequalities_in_mathematica" class="header-anchor">Verifying inequalities in Mathematica</a></h1>
<p><strong>Shuvomoy Das Gupta</strong></p>
<p><em>November 15, 2020</em></p>
<p>In applied mathematics, we often need to use inequalities to simplify our computation. Of course, verifying an inequality would requires picking up pen and paper and proving the it rigorously. However, a good idea prior to that proving phase is to test if the inequality holds for smaller dimensions. This verification for an inequality over smaller dimension can be done efficiently using <code>Mathematica</code>. Here are two simple examples.</p>
<div class="franklin-toc"><ol><li><a href="#a_simple_example_am-gm_inequality">A simple example: AM-GM inequality</a></li><li><a href="#cauchy_inequality">Cauchy inequality</a></li><li><a href="#a_more_complicated_example_performance_estimation_problem">A more complicated example: Performance Estimation Problem</a></li></ol></div>
<h3 id="a_simple_example_am-gm_inequality"><a href="#a_simple_example_am-gm_inequality" class="header-anchor">A simple example: AM-GM inequality</a></h3>
<p>We start with a very simple example: the well-known AM-GM inequality. It states that for \(x>0,y>0\) we have </p>
\[
\frac{x+y}{2} \geq \sqrt{xy}.
\]
<p>We can verify it as follows. </p>
<pre><code class="language-mathematica">&#40;* Clear all the variables, this often comes handy*&#41;
ClearAll&#91;&quot;Global&#96;*&quot;&#93;;

&#40;*construct the conditions*&#41;
conditions &#61; x &gt; 0 &amp;&amp; y &gt; 0;

&#40;*check wheather the AM-GM inequality holds for all x,y satisfying conditions*&#41;

&#40;*Create the AM GM inequality*&#41;
inequalityAMGM &#61; 
 ForAll&#91;&#123;x, y&#125;, 
  conditions, &#40;x &#43; y&#41;/2 &gt;&#61; 
   Sqrt&#91;x y&#93;&#93; 
   
&#40;*Verify if the inequality holds for all x,y satisfying conditions*&#41;   
Resolve&#91;inequalityAMGM&#93;</code></pre>
<p>where we get the output <code>True</code>, so we have verified the AM-GM inequality.</p>
<h3 id="cauchy_inequality"><a href="#cauchy_inequality" class="header-anchor">Cauchy inequality</a></h3>
<p>The Cauchy inequality probably one of the most famous inequalities. Let us verify it in <code>Mathematica</code> for dimension 3.</p>
<pre><code class="language-mathematica">&#40;* Clear all the variables *&#41;
ClearAll&#91;&quot;Global&#96;*&quot;&#93;;

&#40;* Create the Cauchy inequality *&#41;
ineqCauchy &#61; ForAll&#91;&#123;x, y&#125;, Element&#91;x | y, Vectors&#91;3, Reals&#93;&#93;, 
       Abs&#91;x . y&#93; &lt;&#61; Norm&#91;x&#93;*Norm&#91;y&#93;&#93;; 

&#40;* Verify if the inequality holds *&#41;
Resolve&#91;ineqCauchy&#93;</code></pre>
<p>which outputs <code>True</code> again. We can run this for larger dimension too. However, keep in mind that larger the dimension, longer it would take for <code>Mathematica</code> to verify it. Hence, it is best if this verification process is kept confined to a smaller dimension, and then if the verification process yields <code>True</code>, then go for the good old pen and paper to prove it formally. </p>
<h3 id="a_more_complicated_example_performance_estimation_problem"><a href="#a_more_complicated_example_performance_estimation_problem" class="header-anchor">A more complicated example: Performance Estimation Problem</a></h3>
<p>As our final example, we consider verifying an inequality that shows up in the performance estimation problem, for more details about this problem, please see the paper by Taylor et al. <a href="https://arxiv.org/pdf/1502.05666.pdf">here</a>. We want to verify an identity that shows up in Theorem 4 of the mentioned paper. Given vectors \(f_i,f_i,x_i,x_j,g_i,g_j\in \mathbf{R}^n\) we want to show that the following two terms \(t_1\) and \(t_2\) are equal to each other. We have:</p>
\[
t_1 = f_i - f_j - \left\langle g_j \mid x_i - x_j \right\rangle - \frac{1}{2(1/(\mu / L))} \left( \frac{1}{L}\|g_i - g_j \|_2^2 + \mu \|x_i - x_j \|_2^2-\left\langle g_j - g_i \mid x_j - x_i\right\rangle\right)
\]
<p>and</p>
\[
\begin{align*}
s_{i} & =\frac{\mu}{L-\mu}\left\langle g_{i}\mid x_{i}\right\rangle -\frac{\mu L}{2(L-\mu)}\|x_{i}\|_{2}^{2}-\frac{1}{2(L-\mu)}\|g_{i}\|_{2}^{2}\\
s_{j} & =\frac{\mu}{L-\mu}\left\langle g_{j}\mid x_{j}\right\rangle -\frac{\mu L}{2(L-\mu)}\|x_{j}\|_{2}^{2}-\frac{1}{2(L-\mu)}\|g_{j}\|_{2}^{2}\\
p_{ij} & =\left\langle g_{j}-\mu x_{j}\mid\left(\frac{L}{L-\mu}x_{i}-\frac{1}{L-\mu}g_{i}\right)-\left(\frac{L}{L-\mu}x_{j}-\frac{1}{L-\mu}g_{j}\right)\right\rangle \\
t_{2} & =s_{i}-s_{j}-p_{ij}.
\end{align*}
\]
<p>Where \(0<\mu < L\).</p>
<p>First we clear the variables.</p>
<pre><code class="language-mathematica">&#40;*Clear all the variables*&#41;
ClearAll&#91;&quot;Global&#96;*&quot;&#93;;</code></pre>
<p>We are going to do this test for \(n=3\). Let us create our assumptions.</p>
<pre><code class="language-mathematica">n &#61; 3;

myAssumptions &#61; &#40;xi | xj | gi | gj&#41; \&#91;Element&#93; 
   Vectors&#91;n, Reals&#93; &amp;&amp; &#40;\&#91;Mu&#93; | L&#41; \&#91;Element&#93; Reals &amp;&amp; \&#91;Mu&#93; &gt; 0 &amp;&amp; 
  L &gt; 0 &amp;&amp; \&#91;Mu&#93; &lt; L</code></pre>
<p>Let us construct \(t_1\) first.</p>
<pre><code class="language-mathematica">t1 &#61; fi - fj - 
 gj.&#40;xi - xj&#41; - &#40;-&#40;&#40;2 \&#91;Mu&#93; &#40;-gi &#43; gj&#41;.&#40;-xi &#43; xj&#41;&#41;/L&#41; &#43; 
  Norm&#91;gi - gj&#93;^2/L &#43; \&#91;Mu&#93; Norm&#91;xi - xj&#93;^2&#41;/&#40;2 &#40;1 - \&#91;Mu&#93;/L&#41;&#41;</code></pre>
<p>Now, let us construct \(t_2\) by constructing \(s_i,s_j,\) and \(p_{ij}\).</p>
<pre><code class="language-mathematica">si &#61; \&#91;Mu&#93;/&#40;L - \&#91;Mu&#93;&#41; Dot&#91;gi, 
     xi&#93; - &#40;\&#91;Mu&#93; L&#41;/&#40;2 &#40;L - \&#91;Mu&#93;&#41;&#41; Norm&#91;xi&#93;^2 - 
   1/&#40;2 &#40;L - \&#91;Mu&#93;&#41;&#41; Norm&#91;gi&#93;^2 &#43; fi;

sj &#61; \&#91;Mu&#93;/&#40;L - \&#91;Mu&#93;&#41; Dot&#91;gj, 
     xj&#93; - &#40;\&#91;Mu&#93; L&#41;/&#40;2 &#40;L - \&#91;Mu&#93;&#41;&#41; Norm&#91;xj&#93;^2 - 
   1/&#40;2 &#40;L - \&#91;Mu&#93;&#41;&#41; Norm&#91;gj&#93;^2 &#43; fj;
     
pij &#61; Dot&#91;
   gj - \&#91;Mu&#93; xj, &#40;L/&#40;L - \&#91;Mu&#93;&#41; xi - 
      1/&#40;L - \&#91;Mu&#93;&#41; gi&#41; - &#40;L/&#40;L - \&#91;Mu&#93;&#41; xj - 1/&#40;L - \&#91;Mu&#93;&#41; gj&#41;&#93;;
      
t2 &#61; si - sj - pij</code></pre>
<p>Construct the identity now. </p>
<pre><code class="language-mathematica">identityPEP &#61; ForAll&#91;&#123;gi, gj, xi, xj, \&#91;Mu&#93;, L&#125;, myAssumptions, t1&#61;&#61; t2&#93;</code></pre>
<p>Time to resolve.</p>
<pre><code class="language-julia">Resolve&#91;identityPEP&#93;</code></pre>
<p>This yields <code>True</code> &#40;it will take a few minutes&#41; so the identity in question is true for \(n=3\). </p>
<div class="page-foot">
  <div class="copyright">
    &copy; Shuvomoy Das Gupta. Last modified: May 18, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
        </div> <!-- end of id=main -->
    </div> <!-- end of id=layout -->
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>
